<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TIMBX - Your Comprehensive Timber Management Platform</title>
  <script src="https://cdn.tailwindcss.com"></script>
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-control-geocoder/1.13.0/Control.Geocoder.css" />
  
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header class="bg-green-700 text-white p-4 text-center shadow-lg">
    <h1 class="text-4xl font-extrabold tracking-wide">TIMBX</h1>
    <p class="mt-2 text-lg">Your Comprehensive Timber Management Platform</p>
    <p class="text-sm italic mt-1">Connecting landowners, foresters, buyers, and contractors for transparent and efficient timber management.</p>
  </header>

  <nav class="bg-green-800 p-2 shadow-md">
    <div class="container mx-auto flex flex-wrap justify-center space-x-4">
      <a href="#home" data-nav-target="home" class="text-white hover:bg-green-600 px-3 py-2 rounded-md font-bold transition duration-200">Home</a>
      <a href="#marketplace" data-nav-target="marketplace" class="text-white hover:bg-green-600 px-3 py-2 rounded-md font-bold transition duration-200">Marketplace</a>
      <a href="#properties" data-nav-target="properties" class="text-white hover:bg-green-600 px-3 py-2 rounded-md font-bold transition duration-200">My Properties</a>
      <a href="#hunting-leases" data-nav-target="hunting-leases" class="text-white hover:bg-green-600 px-3 py-2 rounded-md font-bold transition duration-200">Hunting Leases</a>
      <a href="#my-projects" data-nav-target="my-projects" class="text-white hover:bg-green-600 px-3 py-2 rounded-md font-bold transition duration-200">My Projects</a>
      <a href="#my-profile" data-nav-target="my-profile" class="text-white hover:bg-green-600 px-3 py-2 rounded-md font-bold transition duration-200">My Profile</a>
      <a href="#my-messages" data-nav-target="my-messages" class="text-white hover:bg-green-600 px-3 py-2 rounded-md font-bold transition duration-200">My Messages</a>
      <button id="login-button" class="bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-md font-bold transition duration-200">Login</button>
      <button id="signup-button" class="bg-yellow-500 hover:bg-yellow-400 text-gray-900 px-4 py-2 rounded-md font-bold transition duration-200">Sign Up</button>
      <button id="logout-button" class="bg-red-500 hover:bg-red-400 text-white px-4 py-2 rounded-md font-bold transition duration-200 hidden">Logout</button>
    </div>
  </nav>

  <main class="container mx-auto p-4">
    <section id="home" class="p-6 bg-white rounded-lg shadow-md mb-6">
      <h2 class="text-3xl font-semibold text-green-700 mb-4">Welcome to TIMBX</h2>
      <p class="text-gray-700 leading-relaxed">
        TIMBX is revolutionizing the timber industry by bringing transparency, efficiency, and direct connections to landowners, foresters, timber buyers, and contractors. We empower you with the tools and information needed to manage your forest assets, find the best market prices, and connect with trusted professionals across the region.
      </p>
      <p class="text-gray-700 leading-relaxed mt-4">
        Discover the true value of your timber, streamline your operations, and foster sustainable forest management practices with an all-in-one platform designed for your success.
      </p>

      <div class="mt-8 border-t pt-6">
        <h3 class="text-2xl font-semibold text-green-700 mb-4">Quick Demo Access</h3>
        <p class="text-gray-700 mb-4">
          Explore TIMBX instantly by logging in as a demo user. No signup required! This mode uses sample data and operates client-side for quick exploration.
        </p>
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
          <button data-demo-role="seller" class="bg-emerald-500 hover:bg-emerald-600 text-white px-4 py-2 rounded-md font-bold transition duration-200 shadow">Demo Seller</button>
          <button data-demo-role="buyer" class="bg-teal-500 hover:bg-teal-600 text-white px-4 py-2 rounded-md font-bold transition duration-200 shadow">Demo Buyer</button>
          <button data-demo-role="forester" class="bg-lime-500 hover:bg-lime-600 text-white px-4 py-2 rounded-md font-bold transition duration-200 shadow">Demo Forester</button>
          <button data-demo-role="contractor" class="bg-indigo-500 hover:bg-indigo-600 text-white px-4 py-2 rounded-md font-bold transition duration-200 shadow">Demo Contractor</button>
        </div>
      </div>
    </section>

    <section id="marketplace" class="hidden-section p-6 bg-white rounded-lg shadow-md mb-6">
      <h2 class="text-3xl font-semibold text-green-700 mb-4">Marketplace</h2>
      <p class="text-gray-700 leading-relaxed mb-4">
        Use the search bar on the map to find a location, and the filters to refine what you see. The list will update automatically as you pan and zoom.
      </p>

      <div id="map-filters" class="flex flex-wrap items-center justify-center gap-4 mb-4 p-2 bg-gray-100 rounded-md">
          <label class="font-medium text-gray-700 flex items-center"><input type="checkbox" id="filter-properties" class="mr-1" checked><span class="legend-dot bg-blue-500"></span>Properties</label>
          <label class="font-medium text-gray-700 flex items-center"><input type="checkbox" id="filter-foresters" class="mr-1" checked><span class="legend-dot bg-green-500"></span>Foresters</label>
          <label class="font-medium text-gray-700 flex items-center"><input type="checkbox" id="filter-buyers" class="mr-1" checked><span class="legend-dot bg-red-500"></span>Buyers</label>
          <label class="font-medium text-gray-700 flex items-center"><input type="checkbox" id="filter-contractors" class="mr-1" checked><span class="legend-dot bg-yellow-500"></span>Contractors</label>
      </div>

      <div id="marketplace-loading-indicator" class="loading-indicator hidden">Loading marketplace data...</div>

      <div class="flex flex-col md:flex-row gap-4">
        <div id="marketplace-map-container" class="w-full md:w-2/3">
          <div id="global-map"></div>
        </div>
        <div id="dynamic-map-list-container" class="w-full md:w-1/3 p-2 border border-gray-200 rounded-md bg-gray-50" style="height: 600px; overflow-y: auto;">
            <h3 class="font-bold text-lg text-gray-800 mb-2 text-center">Showing items in map view</h3>
            <ul id="dynamic-map-list" class="space-y-3">
            </ul>
        </div>
      </div>
    </section>
    
    <section id="properties" class="hidden-section p-6 bg-white rounded-lg shadow-md mb-6">
      <h2 class="text-3xl font-semibold text-green-700 mb-4">My Properties</h2>
      <p id="properties-login-prompt" class="text-red-600 mb-4 hidden">Please log in as a Seller to manage your properties.</p>
      
      <div id="properties-main-content" class="hidden">
        <button id="btn-add-property" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition duration-200 mt-4 mb-4" aria-label="Add a new property listing">Add New Property</button>

        <h3 class="text-2xl font-medium text-gray-800 mt-6 mb-4">Your Listed Properties</h3>
        <p id="no-properties-message" class="text-gray-500 hidden text-center mb-4">No properties added yet. Click "Add New Property" to get started!</p>
        <ul id="property-list" class="grid grid-cols-1 gap-4">
        </ul>
      </div>

      <div id="property-form" class="mt-4 p-4 border border-gray-300 rounded-md bg-gray-50 hidden">
        <h3 class="text-xl font-semibold text-gray-800 mb-3">Add Property Details</h3>
       
        <label for="property-name" class="block text-sm font-medium text-gray-700">Property Name</label>
        <input type="text" id="property-name" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-required="true" aria-label="Property Name">

        <label for="property-desc" class="block text-sm font-medium text-gray-700">Description</label>
        <textarea id="property-desc" rows="3" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Property Description"></textarea>
       
        <label for="property-age" class="block text-sm font-medium text-gray-700">Approx. Age of Timber Stand (years)</label>
        <input type="number" id="property-age" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" min="0" aria-required="true" aria-label="Approximate Age of Timber Stand">

        <label for="property-timber-type" class="block text-sm font-medium text-gray-700">Dominant Timber Type</label>
        <select id="property-timber-type" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-required="true" aria-label="Dominant Timber Type">
          <option value="">Select</option>
          <option value="Pine">Pine</option>
          <option value="Hardwood">Hardwood</option>
          <option value="Mixed">Mixed</option>
          <option value="Cypress">Cypress</option>
        </select>

        <label for="property-species" class="block text-sm font-medium text-gray-700">Dominant Species (e.g., "Loblolly Pine")</label>
        <input type="text" id="property-species" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-required="true" aria-label="Dominant Species">

        <label for="property-subdominant-species" class="block text-sm font-medium text-gray-700">Subdominant Species (Optional, e.g., "Oak, Hickory")</label>
        <input type="text" id="property-subdominant-species" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Subdominant Species">

        <label for="property-previous-cut-year" class="block text-sm font-medium text-gray-700">Previous Cutting Year (Optional)</label>
        <input type="number" id="property-previous-cut-year" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" min="1900" max="2100" aria-label="Previous Cutting Year">

        <label for="property-previous-cut-type" class="block text-sm font-medium text-gray-700">Previous Cutting Type (Optional, e.g., "Clearcut, Thinning")</label>
        <select id="property-previous-cut-type" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Previous Cutting Type">
            <option value="">Select</option>
            <option value="Clear-cut">Clear-cut</option>
            <option value="Marked Thinning">Marked Thinning</option>
            <option value="Operator Select">Operator Select</option>
        </select>
        <label for="property-service-type" class="block text-sm font-medium text-gray-700">Service Offering</label>
        <select id="property-service-type" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-required="true" aria-label="Service Offering Type">
            <option value="">Select Service Type</option>
            <option value="Timber Harvest">Timber Harvest</option>
            <option value="Forester Recommendation">Forester Recommendation</option>
            <option value="Reforestation">Reforestation</option>
            <option value="Firelane Construction">Firelane Construction</option>
        </select>
       
        <p class="text-sm text-gray-600 mb-2">Draw a polygon to outline your property boundaries:</p>
        <div id="property-map" class="mb-4"></div>
        <button id="btn-download-kml" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md transition duration-200 mr-2 hidden" aria-label="Download property boundary as KML">Download Boundary (KML)</button>
        <button id="btn-save-property" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md transition duration-200 mr-2" aria-label="Save property details and boundary">Save Property</button>
        <button id="btn-cancel-property" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md transition duration-200" aria-label="Cancel property submission">Cancel</button>
      </div>
      <div id="property-form-loading-indicator" class="loading-indicator hidden">Saving property...</div>
    </section>

    <section id="hunting-leases" class="hidden-section p-6 bg-white rounded-lg shadow-md mb-6">
      <h2 class="text-3xl font-semibold text-green-700 mb-4">Hunting Lease Management</h2>
      <p id="leases-login-prompt" class="text-red-600 mb-4 hidden">Please log in to manage your hunting leases.</p>

      <div id="landowner-lease-view" class="hidden">
        <button id="btn-create-lease" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition duration-200 mt-4 mb-4">Create New Lease Listing</button>
        
        <h3 class="text-2xl font-medium text-gray-800 mt-6 mb-4">Your Lease Listings & Contracts</h3>
        <p id="no-leases-message" class="text-gray-500 hidden text-center mb-4">You have not listed any properties for lease.</p>
        <ul id="lease-list" class="grid grid-cols-1 gap-4">
        </ul>
      </div>

      <div id="hunter-lease-view" class="hidden">
        <h3 class="text-2xl font-medium text-gray-800 mt-6 mb-4">Your Active Leases</h3>
        <p class="text-gray-500 text-center mb-4">You have no active hunting leases.</p>
        <ul id="hunter-lease-list" class="grid grid-cols-1 gap-4">
        </ul>
      </div>

      <div id="lease-form" class="mt-4 p-4 border border-gray-300 rounded-md bg-gray-50 hidden">
        <h3 class="text-xl font-semibold text-gray-800 mb-3">Create / Edit Lease Listing</h3>
        
        <label for="lease-property-select" class="block text-sm font-medium text-gray-700">Select Property to Lease</label>
        <select id="lease-property-select" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3"></select>

        <label for="lease-title" class="block text-sm font-medium text-gray-700">Lease Title (e.g., "Prime Deer Hunting - 150 Acres")</label>
        <input type="text" id="lease-title" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3">

        <label for="lease-price" class="block text-sm font-medium text-gray-700">Price ($)</label>
        <input type="number" id="lease-price" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" min="0">
        
        <label for="lease-type" class="block text-sm font-medium text-gray-700">Lease Type</label>
        <select id="lease-type" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3">
          <option value="Annual">Annual</option>
          <option value="Seasonal">Seasonal</option>
          <option value="Monthly">Monthly</option>
          <option value="Weekly">Weekly</option>
        </select>

        <label for="lease-game" class="block text-sm font-medium text-gray-700">Allowed Game (e.g., "Deer, Turkey, Waterfowl")</label>
        <input type="text" id="lease-game" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3">

        <label for="lease-rules" class="block text-sm font-medium text-gray-700">Rules & Regulations</label>
        <textarea id="lease-rules" rows="4" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" placeholder="Enter specific rules: guest policy, vehicle use, etc."></textarea>

        <button id="btn-save-lease" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md transition duration-200 mr-2">Save Lease</button>
        <button id="btn-cancel-lease" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md transition duration-200">Cancel</button>
      </div>
    </section>

    <section id="my-projects" class="hidden-section p-6 bg-white rounded-lg shadow-md mb-6">
      <h2 class="text-3xl font-semibold text-green-700 mb-4">My Projects & Bids</h2>
      <p id="my-projects-login-prompt" class="text-red-600 mb-4 hidden">Please log in to view your projects and bids.</p>
      <div id="my-projects-content" class="mt-6">
        <h3 class="text-2xl font-medium text-gray-800 mb-4">Your Active Projects & Bids</h3>
        <p id="no-my-projects-message" class="text-gray-500 hidden text-center mb-4">You have no active projects or bids.</p>
        <ul id="my-projects-list" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        </ul>
      </div>
    </section>

    <section id="my-profile" class="hidden-section p-6 bg-white rounded-lg shadow-md mb-6">
      <h2 class="text-3xl font-semibold text-green-700 mb-4">My Profile</h2>
      <p id="profile-login-prompt" class="text-red-600 mb-4 hidden">Please log in to view your profile.</p>
      <div id="profile-details" class="hidden">
        
        <div class="flex flex-col sm:flex-row items-center sm:items-start space-y-4 sm:space-y-0 sm:space-x-6 mb-6">
          <img id="profile-picture-display" src="" alt="Profile Picture" class="w-32 h-32 rounded-full object-cover border-4 border-green-200 shadow-md">
          <div class="text-center sm:text-left">
            <h3 id="profile-username" class="text-3xl font-bold text-gray-800"></h3>
            <p id="profile-company" class="text-lg text-gray-600"></p>
            <p class="text-lg font-semibold text-gray-800">Role: <span id="profile-role" class="font-normal text-gray-700"></span></p>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          
          <div class="md:col-span-2 space-y-4">
            <div>
              <h4 class="text-xl font-semibold text-green-700 border-b pb-2 mb-2">About Me</h4>
              <p id="profile-bio" class="text-gray-700 leading-relaxed"></p>
            </div>

            <div id="profile-role-specific-data">
              </div>

            <div>
              <h4 class="text-xl font-semibold text-green-700 border-b pb-2 mb-2">Statistics</h4>
              <div class="flex flex-wrap gap-4 text-center">
                <div class="bg-gray-100 p-3 rounded-lg flex-grow">
                  <p class="text-2xl font-bold text-yellow-500" id="profile-rating"></p>
                  <p class="text-sm text-gray-600">Rating (<span id="profile-review-count"></span> reviews)</p>
                </div>
                <div class="bg-gray-100 p-3 rounded-lg flex-grow">
                  <p class="text-2xl font-bold text-green-600" id="profile-transactions"></p>
                  <p class="text-sm text-gray-600">Completed Transactions</p>
                </div>
              </div>
            </div>
          </div>

          <div class="space-y-4">
            <div>
              <h4 class="text-xl font-semibold text-green-700 border-b pb-2 mb-2">Contact</h4>
              <p class="text-sm text-gray-700">Email: <span id="profile-email" class="font-normal text-gray-700"></span></p>
              <p class="text-sm text-gray-500">Member since: <span id="profile-member-since"></span></p>
              <p class="text-sm text-gray-500">User ID: <span id="profile-uid" class="font-normal text-gray-700 text-xs"></span></p>
            </div>
            
            <div id="profile-map-container" class="hidden">
              <h4 class="text-xl font-semibold text-green-700 border-b pb-2 mb-2">Service Area</h4>
              <div id="profile-map-display" class="w-full h-64 rounded-lg border"></div>
            </div>
          </div>
        </div>
        
        <button id="edit-my-profile-button" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md font-bold transition duration-200 mt-8" aria-label="Edit My Profile">Edit Profile</button>
      </div>
    </section>

    <section id="my-messages" class="hidden-section p-6 bg-white rounded-lg shadow-md mb-6">
      <h2 class="text-3xl font-semibold text-green-700 mb-4">My Messages</h2>
      <p id="messages-login-prompt" class="text-red-600 mb-4 hidden">Please log in to view your messages.</p>
      <div id="messages-content" class="hidden">
        <p class="text-gray-700 mb-4 italic">Note: For a fully functional, real-time messaging system between users, a backend database (like Firestore) is required to store and sync messages securely across different users and sessions. These are static examples.</p>
        <div id="message-list" class="space-y-4">
          <div class="p-4 border border-gray-200 rounded-md bg-gray-50">
            <p class="font-bold text-green-800">From: Forester John</p>
            <p class="text-sm text-gray-600">Date: 2025-08-10</p>
            <p class="mt-2 text-gray-700">Hi, I'm interested in your property "Whispering Pines Lot". Can you provide more details about the access road conditions?</p>
          </div>
          <div class="p-4 border border-gray-200 rounded-md bg-gray-50">
            <p class="font-bold text-green-800">From: Buyer Jane</p>
            <p class="text-sm text-gray-600">Date: 2025-08-08</p>
            <p class="mt-2 text-gray-700">Regarding Lot #123, what's the estimated volume of pine pulpwood?</p>
          </div>
          <div class="p-4 border border-gray-200 rounded-md bg-gray-50">
            <p class="font-bold text-green-800">From: System Notification</p>
            <p class="text-sm text-gray-600">Date: 2025-08-05</p>
            <p class="mt-2 text-gray-700">Your bid on "Mixed Hardwood - Lot 7" is currently the highest. Auction closes in 2 days!</p>
          </div>
          <p class="text-gray-500 text-center mt-6">--- End of Messages ---</p>
        </div>
      </div>
    </section>

    <section id="about" class="hidden-section p-6 bg-white rounded-lg shadow-md mb-6">
      <h2 class="text-3xl font-semibold text-green-700 mb-4">About TIMBERHUB</h2>
      <p class="text-gray-700 leading-relaxed">
        TIMBERHUB was founded on the principle that the timber market should be transparent and accessible to everyone. We believe in empowering landowners to get fair prices for their timber and connecting them with reliable, skilled professionals. Our platform streamlines the entire process, from property assessment to harvest and beyond, ensuring sustainable practices and maximizing value.
      </p>
    </section>
  </main>

  <div id="login-modal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="login-modal-title">
    <div class="modal-content">
      <span id="close-login-modal" class="close-button" aria-label="Close Login dialog">&times;</span>
      <h2 id="login-modal-title" class="text-2xl font-bold mb-4 text-green-700">Login to TIMBERHUB</h2>
      <form id="login-form">
        <div id="login-message" class="text-red-500 mb-3 hidden" aria-live="polite"></div>
        <label for="login-email" class="block text-sm font-medium text-gray-700">Email</label>
        <input type="email" id="login-email" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-required="true" aria-label="Login Email" autocomplete="username">
        <label for="login-password" class="block text-sm font-medium text-gray-700">Password</label>
        <input type="password" id="login-password" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-4" aria-required="true" aria-label="Login Password" autocomplete="current-password">
        <button id="handle-login-button" type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md w-full transition duration-200" aria-label="Login with email and password">Login</button>
      </form>
      <div class="flex items-center justify-center my-4">
        <div class="border-b w-full border-gray-300"></div>
        <div class="px-2 text-gray-500 text-sm">OR</div>
        <div class="border-b w-full border-gray-300"></div>
      </div>
      <button id="handle-google-sign-in-button" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md w-full flex items-center justify-center transition duration-200" aria-label="Sign in with Google">
        <svg class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12.24 10.27v2.4h3.64c-.2 1.35-1.55 3.03-3.64 3.03-2.4 0-4.36-1.9-4.36-4.25s1.96-4.25 4.36-4.25c1.17 0 2.2.49 2.95 1.25l1.97-1.97c-1.2-1.12-2.78-1.87-4.92-1.87-4.14 0-7.5 3.32-7.5 7.42s3.36 7.42 7.5 7.42c4.19 0 7.2-2.92 7.2-7.27 0-.5-.07-.98-.18-1.42H12.24z"/>
        </svg>
        Sign in with Google
      </button>
      <p class="text-center text-sm text-gray-600 mt-4">Don't have an account? <a href="#" id="show-signup-from-login-link" class="text-blue-600 hover:underline" aria-label="Sign up from login dialog">Sign Up</a></p>
    </div>
  </div>

  <div id="signup-modal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="signup-modal-title">
    <div class="modal-content">
      <span id="close-signup-modal" class="close-button" aria-label="Close Sign Up dialog">&times;</span>
      <h2 id="signup-modal-title" class="text-2xl font-bold mb-4 text-green-700">Join TIMBERHUB</h2>
      <form id="signup-form">
        <div id="signup-message" class="text-red-500 mb-3 hidden" aria-live="polite"></div>
        <label for="signup-username" class="block text-sm font-medium text-gray-700">Choose a Username</label>
        <input type="text" id="signup-username" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" required>
        <label for="signup-email" class="block text-sm font-medium text-gray-700">Email</label>
        <input type="email" id="signup-email" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" required>
        <label for="signup-password" class="block text-sm font-medium text-gray-700">Password</label>
        <input type="password" id="signup-password" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" required>
        <label for="signup-role" class="block text-sm font-medium text-gray-700">I am a:</label>
        <select id="signup-role" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-4" required>
          <option value="">Select Role</option>
          <option value="seller">Landowner/Seller</option>
          <option value="buyer">Timber Buyer</option>
          <option value="forester">Forester</option>
          <option value="contractor">Contractor (Logging, Planting, etc.)</option>
        </select>

        <div class="border-t pt-4 mt-4 space-y-3">
            <h3 class="text-lg font-semibold text-gray-800">Optional Profile Details</h3>
            <label for="signup-profile-picture-url" class="block text-sm font-medium text-gray-700">Profile Picture URL</label>
            <input type="url" id="signup-profile-picture-url" placeholder="https://example.com/mypicture.jpg" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm">
            
            <label for="signup-company" class="block text-sm font-medium text-gray-700">Company Name</label>
            <input type="text" id="signup-company" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm">

            <label for="signup-bio" class="block text-sm font-medium text-gray-700">Short Bio</label>
            <textarea id="signup-bio" rows="3" placeholder="Tell us a little about yourself or your company..." class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm"></textarea>
        </div>

        <div id="forester-fields" class="hidden border-t pt-4 mt-4">
          <h3 class="text-lg font-semibold mb-2 text-gray-800">Forester Profile</h3>
          <label for="forester-location" class="block text-sm font-medium text-gray-700">Location Served (e.g., "Arkansas, Oklahoma")</label>
          <input type="text" id="forester-location" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Forester Location Served">
          <label for="forester-experience" class="block text-sm font-medium text-gray-700">Experience (e.g., "15 years, timber cruising, reforestation")</label>
          <textarea id="forester-experience" rows="2" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Forester Experience"></textarea>
          <label for="forester-certifications" class="block text-sm font-medium text-gray-700">Certifications/Specialties (e.g., "ACF, SAF, Timber Appraisal")</label>
          <input type="text" id="forester-certifications" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Forester Certifications and Specialties">
          <p class="text-sm text-gray-600 mb-2 mt-4 font-semibold">Click on the map to set your public display location:</p>
          <p class="text-xs text-red-500 italic mb-2">Note: This location is for public display on the map, but not your exact address.</p>
          <div id="forester-signup-map" class="mb-4"></div>
        </div>

        <div id="buyer-fields" class="hidden border-t pt-4 mt-4">
          <h3 class="text-lg font-semibold mb-2 text-gray-800">Buyer Profile</h3>
          <label for="buyer-location" class="block text-sm font-medium text-gray-700">Base Location (e.g., "Springfield, MO")</label>
          <input type="text" id="buyer-location" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Buyer Base Location">
          <label for="buyer-looking-for" class="block text-sm font-medium text-gray-700">What are you looking to buy? (e.g., "Pine Sawtimber, Oak Veneer Logs")</label>
          <textarea id="buyer-looking-for" rows="2" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Buyer Looking For"> </textarea>
          <label for="buyer-locations-served" class="block text-sm font-medium text-gray-700">Locations Served (e.g., "Arkansas, Louisiana, Mississippi")</label>
          <input type="text" id="buyer-locations-served" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Buyer Locations Served">
          <p class="text-sm text-gray-600 mb-2 mt-4 font-semibold">Click on the map to set your public display location:</p>
          <p class="text-xs text-red-500 italic mb-2">Note: This location is for public display on the map, but not your exact address.</p>
          <div id="buyer-signup-map" class="mb-4"></div>
        </div>

        <div id="contractor-fields" class="hidden border-t pt-4 mt-4">
          <h3 class="text-lg font-semibold mb-2 text-gray-800">Contractor Profile</h3>
          <label for="contractor-location" class="block text-sm font-medium text-gray-700">Base Location (e.g., "Texarkana, TX")</label>
          <input type="text" id="contractor-location" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Contractor Base Location">
          <label for="contractor-services" class="block text-sm font-medium text-gray-700">Services Offered (e.g., "Logging, Firelane Clearing, Reforestation")</label>
          <textarea id="contractor-services" rows="2" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Contractor Services Offered"></textarea>
          <label for="contractor-locations-served" class="block text-sm font-medium text-gray-700">Locations Served (e.g., "Western Arkansas, Eastern Oklahoma")</label>
          <input type="text" id="contractor-locations-served" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm mb-3" aria-label="Contractor Locations Served">
          <p class="text-sm text-gray-600 mb-2 mt-4 font-semibold">Click on the map to set your public display location:</p>
          <p class="text-xs text-red-500 italic mb-2">Note: This location is for public display on the map, but not your exact address.</p>
          <div id="contractor-signup-map" class="mb-4"></div>
        </div>

        <button id="handle-signup-button" type="submit" class="bg-yellow-500 hover:bg-yellow-600 text-gray-900 px-4 py-2 rounded-md w-full transition duration-200 mt-4">Sign Up</button>
      </form>
      <p class="text-center text-sm text-gray-600 mt-4">Already have an account? <a href="#" id="show-login-from-signup-link" class="text-blue-600 hover:underline" aria-label="Login from sign up dialog">Login</a></p>
    </div>
  </div>
  
  <div id="edit-profile-modal" class="full-page-section hidden" role="dialog" aria-modal="true" aria-labelledby="edit-profile-modal-title">
    <div class="modal-content">
      <span id="close-edit-profile-modal" class="close-button" aria-label="Close Edit Profile dialog">&times;</span>
      <h2 id="edit-profile-modal-title" class="text-2xl font-bold mb-4 text-green-700">Edit Your Profile</h2>
      <form id="edit-profile-form">
        <div id="edit-profile-message" class="text-red-500 mb-3 hidden" aria-live="polite"></div>
        
        <h3 class="text-lg font-semibold text-gray-800 border-b pb-2 mb-3">General Information</h3>
        <div class="space-y-3">
          <label for="edit-username" class="block text-sm font-medium text-gray-700">Username</label>
          <input type="text" id="edit-username" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm" required>
          
          <label for="edit-profile-picture-url" class="block text-sm font-medium text-gray-700">Profile Picture URL</label>
          <input type="url" id="edit-profile-picture-url" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm">
          
          <label for="edit-company" class="block text-sm font-medium text-gray-700">Company Name</label>
          <input type="text" id="edit-company" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm">

          <label for="edit-bio" class="block text-sm font-medium text-gray-700">Short Bio</label>
          <textarea id="edit-bio" rows="3" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm"></textarea>
        </div>

        <div id="edit-forester-fields" class="hidden space-y-3 mt-4">
          <h3 class="text-lg font-semibold mt-4 text-gray-800 border-t pt-3">Forester Details</h3>
          <label for="edit-forester-experience" class="block text-sm font-medium text-gray-700">Years of Experience</label>
          <input type="number" id="edit-forester-experience" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm">
          
          <label class="block text-sm font-medium text-gray-700">Specialties (check all that apply)</label>
          <div id="edit-forester-specialties" class="grid grid-cols-2 gap-2 text-sm">
              <label class="flex items-center"><input type="checkbox" value="Timber Cruising" class="mr-2">Timber Cruising</label>
              <label class="flex items-center"><input type="checkbox" value="Appraisal" class="mr-2">Appraisal</label>
              <label class="flex items-center"><input type="checkbox" value="Reforestation" class="mr-2">Reforestation</label>
              <label class="flex items-center"><input type="checkbox" value="Management Plans" class="mr-2">Management Plans</label>
              <label class="flex items-center"><input type="checkbox" value="Prescribed Burning" class="mr-2">Prescribed Burning</label>
          </div>
        </div>

        <div id="edit-buyer-fields" class="hidden space-y-3 mt-4">
          <h3 class="text-lg font-semibold mt-4 text-gray-800 border-t pt-3">Buyer Details</h3>
          <label for="edit-buyer-looking-for" class="block text-sm font-medium text-gray-700">What are you looking to buy?</label>
          <textarea id="edit-buyer-looking-for" rows="2" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm"></textarea>
        </div>

        <div id="edit-contractor-fields" class="hidden space-y-3 mt-4">
          <h3 class="text-lg font-semibold mt-4 text-gray-800 border-t pt-3">Contractor Details</h3>
          <label class="block text-sm font-medium text-gray-700">Services Offered (check all that apply)</label>
          <div id="edit-contractor-services" class="grid grid-cols-2 gap-2 text-sm">
              <label class="flex items-center"><input type="checkbox" value="Logging" class="mr-2">Logging</label>
              <label class="flex items-center"><input type="checkbox" value="Planting" class="mr-2">Planting</label>
              <label class="flex items-center"><input type="checkbox" value="Site Prep" class="mr-2">Site Prep</label>
              <label class="flex items-center"><input type="checkbox" value="Firelane Clearing" class="mr-2">Firelane Clearing</label>
              <label class="flex items-center"><input type="checkbox" value="Hauling" class="mr-2">Hauling</label>
          </div>
        </div>
        
        <div id="edit-profile-map-container" class="hidden mt-4">
          <h3 class="text-lg font-semibold mt-4 text-gray-800 border-t pt-3">Update Your Location & Service Area</h3>
          <p class="text-sm text-gray-600 mb-2">
              Click and drag the pin to adjust your public location. Then, use the slider to set the radius of your service area in miles.
          </p>
          <div class="my-4">
              <label for="service-radius-slider" class="block text-sm font-medium text-gray-700">Service Radius: <span id="service-radius-value" class="font-bold">50</span> miles</label>
              <input type="range" id="service-radius-slider" min="5" max="250" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
          </div>
          <div id="edit-profile-map" class="mb-4"></div>
        </div>

        <div class="mt-6 flex justify-end space-x-3">
          <button type="button" id="cancel-edit-profile-button" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-md font-bold transition">Cancel</button>
          <button type="submit" id="save-profile-changes-button" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md font-bold transition">Save Changes</button>
        </div>
      </form>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tokml/0.4.0/tokml.min.js"></script>
  
  <script type="module" src="js/main.js"></script>
</body>
</html>